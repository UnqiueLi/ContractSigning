{"version":3,"sources":["uni-app:///main.js","webpack:///F:/11111/uview-template 集成uview-ui 的基础项目开发框架/subpkg_index/pages/enterGrass/enterGrass.vue?af2d","webpack:///F:/11111/uview-template 集成uview-ui 的基础项目开发框架/subpkg_index/pages/enterGrass/enterGrass.vue?225c","webpack:///F:/11111/uview-template 集成uview-ui 的基础项目开发框架/subpkg_index/pages/enterGrass/enterGrass.vue?39bf","webpack:///F:/11111/uview-template 集成uview-ui 的基础项目开发框架/subpkg_index/pages/enterGrass/enterGrass.vue?afa6","uni-app:///subpkg_index/pages/enterGrass/enterGrass.vue","webpack:///F:/11111/uview-template 集成uview-ui 的基础项目开发框架/subpkg_index/pages/enterGrass/enterGrass.vue?b993","webpack:///F:/11111/uview-template 集成uview-ui 的基础项目开发框架/subpkg_index/pages/enterGrass/enterGrass.vue?047c"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","uId","formList","formData","addressNames","addressIds","settingContent","picUrlList","videoUrl","farmHouseholdId","type","number","images","imagesUrl","serverImages","serverVideoUrl","videoPoster","videoDuration","baseUrl","showRegionPicker","defaultRegion","region","province","city","area","onLoad","console","onShow","uni","frontColor","backgroundColor","methods","chooseAddress","onRegionConfirm","getList","title","userApi","item","radioChange","chooseImage","count","sizeType","sourceType","success","res","uploadTasks","Promise","results","fail","uploadSingleImage","url","filePath","name","header","resolve","localPath","serverPath","reject","deleteImage","content","chooseVideo","maxDuration","camera","duration","uploadRes","includes","imgUrl","previewImage","imageUrls","current","urls","icon","submitForm","requiredFields","setTimeout","getAddressIds","showToast","resetForm","phone","notes","company","mu","seedType","avgHeight","density","rfv","greenLevel","cutCount","packaging"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,mBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuH;AACvH;AAC8D;AACL;AACc;;;AAGvE;AAC+L;AAC/L,gBAAgB,wMAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,qFAAM;AACR,EAAE,8FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,yFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,mQAEN;AACP,KAAK;AACL;AACA,aAAa,uSAEN;AACP,KAAK;AACL;AACA,aAAa,6MAEN;AACP,KAAK;AACL;AACA,aAAa,uMAEN;AACP,KAAK;AACL;AACA,aAAa,yQAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACrEA;AAAA;AAAA;AAAA;AAAsuB,CAAgB,2vBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;ACsG1vB;AAGA;AACA;AAAA;AAAA;AAAA;AAAA,eAEA;EACAC;IACA;MACAC;MACAC;MACAC;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;MACA;MACA;MACAC;MAAA;MACAC;MACAC;MAAA;MACAN;MAAA;MACAO;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;MACA;IACA;EACA;EACAC;IACAC;IACA;IACA;IACAA;IACA;EACA;EACAC;IACA;IACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MACA;;MAEA;MACA;MACA;;MAEA;MACA;QACA;QACA;QACAP;QACA;QACA;QACA;MACA;;MAEA;MACA;IACA;IACA;IACAQ;MAAA;MACA;MACAN;QACAO;MACA;;MAEA;MACAC;QACA;QACAR;QAEAF;QACA;QACAA;;QAEA;QACA;UACA;UACA;YACAW;UACA;QACA;;QAEA;QACA;QACA;;QAEA;QACA;UAAA,OACAA;QAAA;QAEA;UACA;QACA;MACA;QACA;QACAT;QAEAF;QACA;MACA;IACA;IACAY;MACAZ;IACA;IAEA;IACAa;MAAA;MACA;MACA;MACA;QACA;QACA;MACA;MAEAX;QACAY;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;UACAjB;;UAEA;UACAE;YACAO;UACA;UAEA;;UAEA;UACAS;YACAC;UACA;;UAEA;UACAC;YACAlB;YACA;;YAEA;YACAmB;cACA;gBACA;gBACA;cACA;YACA;UAEA;YACAnB;YACA;YACAF;UACA;QACA;QACAsB;UACAtB;QACA;MACA;IACA;IAEA;IACAuB;MAAA;MACA;QACA;QACA;;QAEA;QACA;QAEAvB;QAEAE;UACAsB;UACAC;UACAC;UAAA;UACAjD;YACA;YACAF;UACA;UACAoD;YACA;UACA;UACAV;YACAjB;YACA;cACA;cACA,qEACA1B;cACA0B;;cAEA;cACA;gBACA;gBACA;gBACA;cACA;;cAEA;cACA;gBACA;gBACA,6DACA1B;gBACA0B;gBAEA4B;kBACAC;kBACAC;gBACA;cACA;gBACA9B;gBACA+B;cACA;YACA;cACA/B;cACA;cACA;gBACA;kBACA4B;oBACAC;oBACA;oBACAC;kBACA;gBACA;kBACAC;gBACA;cACA;gBACAA;cACA;YACA;UACA;UACAT;YACAtB;YACA+B;UACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MACA9B;QACAO;QACAwB;QACAhB;UACA;YACA;YACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAiB;MAAA;MACAhC;QACAc;QAAA;QACAmB;QAAA;QACAC;QACAnB;UACAjB;;UAEA;UACA;YACA;YACA;UACA;;UAEA;UACAE;YACAO;UACA;;UAEA;UACA;UACA;;UAEA;UACA;YACA;UACA;;UAEA;UACA;UACA;UACA;UAEAT;;UAEA;UACA;UAEAE;YACAsB;YACAC;YACAC;YAAA;YACAjD;cACA;cACAF;cACA8D;YACA;YACAV;cACA;YACA;YACAV;cACAf;cACAF;cACA;gBACA,2DACAsC;gBACAtC;;gBAEA;gBACA;kBACA;kBACA,oDACA1B,gDACA;kBACA0B;kBACA;kBACA;kBACA;gBACA;kBACAA;kBACA;gBACA;cACA;gBACAA;gBACA;gBACA,yDACAuC;kBACA;oBACA;oBACA,mDACAC;oBACA;kBACA;oBACA;kBACA;gBACA;kBACA;gBACA;cACA;YACA;YACAlB;cACApB;cACAF;cACA;YACA;UACA;QACA;QACAsB;UACAtB;QACA;MACA;IACA;IAEAyC;MACA;MACA;;MAEA;MACA;QACAC;MACA;QACA;QACAA;MACA;MAEA1C;;MAEA;MACAE;QACAyC;QACAC;QACA3B;UACAjB;QACA;QACAsB;UACAtB;UACAE;YACAO;YACAoC;UACA;QACA;MACA;IACA;IAEAC;MAAA;MACA;MACA;;MAEA;MACA;QAAA,OACAnC;MAAA;MAEA;QACA;QACAX;MACA;QACA;QACA;UAAA,OACAW,cACAA,4BACAA,4BACAA,4BACAA,yBACA;QAAA,EACA;QAEA;UACA;UACAX;QACA;UACAA;QACA;MACA;MAEAA;;MAEA;MACA;MACA;MAAA,2CAEA;QAAA;MAAA;QAAA;UAAA;UACA;UACA;YACA+C;UACA;QACA;MAAA;QAAA;MAAA;QAAA;MAAA;MAEA;QACA;QACA;MACA;;MAEA;MACA;QACA;QACA;MACA;;MAEA;MACA;QACA;QACA;MACA;;MAEA;MACA;QACA;QACA;MACA;;MAEA;MACA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA7C;QACAO;MACA;;MAGA;MACA;QACAT;QACA;UAAA;UACAE;UACA;UACA;QACA;MACA;MAEAF;;MAEA;MACAU;QACAR;QAEA;UACAA;YACAO;YACAoC;UACA;;UAEA;UACAG;YACA9C;UACA;QACA;UACA;QACA;MACA;QACAA;QACAF;QACA;MACA;IACA;IAEA;IACAiD;MACA;MACA;MACA;IACA;IAEAC;MACAhD;QACAO;QACAoC;MACA;IACA;IAEAM;MACA;QACAzB;QACA0B;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC9pBA;AAAA;AAAA;AAAA;AAAy3C,CAAgB,s1CAAG,EAAC,C;;;;;;;;;;;ACA74C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"subpkg_index/pages/enterGrass/enterGrass.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './subpkg_index/pages/enterGrass/enterGrass.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./enterGrass.vue?vue&type=template&id=a59732fc&\"\nvar renderjs\nimport script from \"./enterGrass.vue?vue&type=script&lang=js&\"\nexport * from \"./enterGrass.vue?vue&type=script&lang=js&\"\nimport style0 from \"./enterGrass.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"subpkg_index/pages/enterGrass/enterGrass.vue\"\nexport default component.exports","export * from \"-!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./enterGrass.vue?vue&type=template&id=a59732fc&\"","var components\ntry {\n  components = {\n    uInput: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-input/u-input\" */ \"@/uview-ui/components/u-input/u-input.vue\"\n      )\n    },\n    uRadioGroup: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-radio-group/u-radio-group\" */ \"@/uview-ui/components/u-radio-group/u-radio-group.vue\"\n      )\n    },\n    uRadio: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-radio/u-radio\" */ \"@/uview-ui/components/u-radio/u-radio.vue\"\n      )\n    },\n    uIcon: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-icon/u-icon\" */ \"@/uview-ui/components/u-icon/u-icon.vue\"\n      )\n    },\n    uPicker: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-picker/u-picker\" */ \"@/uview-ui/components/u-picker/u-picker.vue\"\n      )\n    },\n    uButton: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-button/u-button\" */ \"@/uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.images.length\n  var g1 = _vm.images.length\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./enterGrass.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./enterGrass.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"page-container\">\r\n\t\t<!-- 顶部背景 -->\r\n\t\t<view class=\"bg-header\"></view>\r\n\r\n\t\t<view class=\"enterImg\">\r\n\t\t\t<image src=\"/static/image/enter.png\" mode=\"\"></image>\r\n\t\t</view>\r\n\r\n\t\t<!-- 内容区 -->\r\n\t\t<view class=\"form-container\">\r\n\t\t\t<view class=\"form-title\">请填写信息</view>\r\n\t\t\t<view class=\"\" v-for=\"(item,index) in formList\" :key=\"index\">\r\n\t\t\t\t<view class=\"form-item\" v-if=\"item.type == 'input'\">\r\n\t\t\t\t\t<view class=\"item-label\">{{item.name}}</view>\r\n\t\t\t\t\t<u-input class=\"item-input\" v-model=\"item.value\" :placeholder=\"'请填写'+item.name\"\r\n\t\t\t\t\t\t:border=\"false\"></u-input>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"form-item radio-item\" v-if=\"item.type == 'radio'\">\r\n\t\t\t\t\t<view class=\"item-label\">{{item.name}}</view>\r\n\t\t\t\t\t<view class=\"radio-group\">\r\n\t\t\t\t\t\t<u-radio-group v-model=\"item.value\" placement=\"row\">\r\n\t\t\t\t\t\t\t<u-radio v-for=\"(data, indexs) in item.options\" :key=\"indexs\" :name=\"data.value\"\r\n\t\t\t\t\t\t\t\t:label=\"data.value\" active-color=\"#65ad66\" @change=\"radioChange\">\r\n\t\t\t\t\t\t\t\t{{data.value}}\r\n\t\t\t\t\t\t\t</u-radio>\r\n\t\t\t\t\t\t</u-radio-group>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"item-label\">地理位置</view>\r\n\t\t\t\t<u-input class=\"item-input\" v-model=\"formData.addressNames\" placeholder=\"省市区\" :border=\"false\" disabled\r\n\t\t\t\t\t@click=\"chooseAddress\"></u-input>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 照片上传区域 -->\r\n\t\t<view class=\"upload-section\">\r\n\t\t\t<view class=\"upload-title\">请上传照片 <text class=\"upload-subtitle\">(照片不低于5张)</text></view>\r\n\r\n\t\t\t<view class=\"image-upload-area\">\r\n\t\t\t\t<!-- 已上传照片展示 -->\r\n\t\t\t\t<view class=\"image-list\" v-if=\"images.length > 0\">\r\n\t\t\t\t\t<view class=\"image-item\" v-for=\"(item, index) in images\" :key=\"index\">\r\n\t\t\t\t\t\t<image :src=\"item\" mode=\"aspectFill\" @click=\"previewImage(item, images)\"></image>\r\n\t\t\t\t\t\t<view class=\"delete-icon\" @click.stop=\"deleteImage(index)\">\r\n\t\t\t\t\t\t\t<u-icon name=\"close\" color=\"#fff\" size=\"20\"></u-icon>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 上传按钮 -->\r\n\t\t\t\t<view class=\"upload-button\" v-if=\"images.length < 10\" @click=\"chooseImage()\">\r\n\t\t\t\t\t<view class=\"upload-icon\">\r\n\t\t\t\t\t\t<u-icon name=\"camera\" size=\"36\" color=\"#c0c4cc\"></u-icon>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"upload-text\">上传照片</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 视频上传区域 -->\r\n\t\t<view class=\"upload-section\">\r\n\t\t\t<view class=\"upload-title\">请上传视频 <text class=\"upload-subtitle\"> (视频不低于20秒)</text></view>\r\n\r\n\t\t\t<!-- 视频未上传状态 -->\r\n\t\t\t<view class=\"video-upload-button\" v-if=\"!videoUrl\" @click=\"chooseVideo\">\r\n\t\t\t\t<view class=\"upload-icon\">\r\n\t\t\t\t\t<u-icon name=\"play-right\" size=\"36\" color=\"#c0c4cc\"></u-icon>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"upload-text\">上传视频</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 视频已上传状态 -->\r\n\t\t\t<view class=\"video-container\" v-else>\r\n\t\t\t\t<video :src=\"videoUrl\" controls show-center-play-btn show-play-btn initial-time=\"0\" class=\"video-player\"\r\n\t\t\t\t\t:poster=\"videoPoster\"></video>\r\n\t\t\t\t<view class=\"edit-video-btn\" @click=\"chooseVideo\">\r\n\t\t\t\t\t<u-icon name=\"reload\" color=\"#fff\" size=\"24\"></u-icon>\r\n\t\t\t\t\t<text class=\"edit-video-text\">更换视频</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 省市区选择器 -->\r\n\t\t<u-picker mode=\"region\" v-model=\"showRegionPicker\" :default-region=\"defaultRegion\"\r\n\t\t\t@confirm=\"onRegionConfirm\"></u-picker>\r\n\t\t<!-- 底部按钮 -->\r\n\t\t<!-- 添加占位区域，防止内容被底部footer遮挡 -->\r\n\t\t<view class=\"footer-placeholder\"></view>\r\n\r\n\t\t<view class=\"footer\">\r\n\t\t\t<u-button class=\"btn\" :custom-style=\"{border: 'none'}\" @click=\"submitForm\">\r\n\t\t\t\t提交信息\r\n\t\t\t</u-button>\r\n\t\t</view>\r\n\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tuserApi\r\n\t} from '../../../api/user.js';\r\n\timport settings from '../../../common/settings.js';\r\n\timport request from '../../../utils/request.js';\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tuId: '',\r\n\t\t\t\tformList: [],\r\n\t\t\t\tformData: {\r\n\t\t\t\t\taddressNames: '', // 地区名称\r\n\t\t\t\t\taddressIds: '', // 地区ID\r\n\t\t\t\t\tsettingContent: '', // 参数\r\n\t\t\t\t\tpicUrlList: '', //  照片url\r\n\t\t\t\t\tvideoUrl: '', //  视频url\r\n\t\t\t\t\tfarmHouseholdId: '', // 牧户ID\r\n\t\t\t\t\ttype: '' ,// 品类\r\n\t\t\t\t\tnumber:''\r\n\t\t\t\t},\r\n\t\t\t\t// 将初始图片列表置空，让用户自己上传\r\n\t\t\t\timages: [], // 本地图片路径\r\n\t\t\t\timagesUrl: [],\r\n\t\t\t\tserverImages: [], // 服务器返回的图片URL\r\n\t\t\t\tvideoUrl: \"\", // 本地视频URL\r\n\t\t\t\tserverVideoUrl: \"\", // 服务器返回的视频URL\r\n\t\t\t\tvideoPoster: \"/static/imgCs/1.png\", // 视频封面\r\n\t\t\t\tvideoDuration: 0, // 视频时长（秒）\r\n\t\t\t\tbaseUrl: process.env.NODE_ENV === 'development' ? settings.devUrl : settings.prodUrl, // 基础URL\r\n\t\t\t\tshowRegionPicker: false,\r\n\t\t\t\tdefaultRegion: ['北京市', '北京市', '东城区'],\r\n\t\t\t\tregion: {\r\n\t\t\t\t\tprovince: '',\r\n\t\t\t\t\tcity: '',\r\n\t\t\t\t\tarea: ''\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tconsole.log(options);\r\n\t\t\tthis.uId = options.id;\r\n\t\t\tthis.formData.type = options.name;\r\n\t\t\tconsole.log(this.formData.type)\r\n\t\t\tthis.getList();\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\t// 设置导航栏背景色与bg-header起始颜色一致\r\n\t\t\tuni.setNavigationBarColor({\r\n\t\t\t\tfrontColor: '#ffffff',\r\n\t\t\t\tbackgroundColor: '#63B872'\r\n\t\t\t})\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 显示省市区选择器\r\n\t\t\tchooseAddress() {\r\n\t\t\t\tthis.showRegionPicker = true;\r\n\t\t\t},\r\n\t\t\tonRegionConfirm(e) {\r\n\t\t\t\tthis.region.province = e.province.label;\r\n\t\t\t\tthis.region.city = e.city.label;\r\n\t\t\t\tthis.region.area = e.area.label;\r\n\r\n\t\t\t\t// 格式化显示省市区\r\n\t\t\t\tconst formattedAddress = `${this.region.province} ${this.region.city} ${this.region.area}`;\r\n\t\t\t\tthis.formData.addressNames = formattedAddress;\r\n\r\n\t\t\t\t// 如果有省市区的code值，可以设置真实的addressIds\r\n\t\t\t\tif (e.province.value && e.city.value && e.area.value) {\r\n\t\t\t\t\t// 使用真实的区域代码作为addressIds\r\n\t\t\t\t\tconst addressCodes = `${e.province.value},${e.city.value},${e.area.value}`;\r\n\t\t\t\t\tconsole.log('地区代码:', addressCodes);\r\n\t\t\t\t\tthis.formData.addressIds = addressCodes;\r\n\t\t\t\t\t// 如果后端需要区域代码而不是名称，可以取消下面的注释\r\n\t\t\t\t\t// this.formData.addressIds = addressCodes;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 关闭选择器\r\n\t\t\t\tthis.showRegionPicker = false;\r\n\t\t\t},\r\n\t\t\t// 接口请求\r\n\t\t\tgetList() {\r\n\t\t\t\t// 显示加载中\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '加载中...'\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// 品类列表\r\n\t\t\t\tuserApi.getMucaoInfo(this.uId).then(res => {\r\n\t\t\t\t\t// 隐藏加载中\r\n\t\t\t\t\tuni.hideLoading();\r\n\r\n\t\t\t\t\tconsole.log(res.data);\r\n\t\t\t\t\tthis.formList = JSON.parse(res.data.content);\r\n\t\t\t\t\tconsole.log(this.formList);\r\n\r\n\t\t\t\t\t// 初始化表单项的value\r\n\t\t\t\t\tthis.formList.forEach(item => {\r\n\t\t\t\t\t\t// 如果表单项没有value，初始化一个空值\r\n\t\t\t\t\t\tif (!item.hasOwnProperty('value')) {\r\n\t\t\t\t\t\t\titem.value = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 设置farmHouseholdId\r\n\t\t\t\t\tconst userInfo = uni.getStorageSync('userInfo');\r\n\t\t\t\t\tthis.formData.farmHouseholdId = userInfo.user.userId;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 查找并初始化总量字段\r\n\t\t\t\t\tconst quantityField = this.formList.find(item => \r\n\t\t\t\t\t\titem.name && (item.name.includes('总量/吨') || item.name.includes('总量/亩')));\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (quantityField && quantityField.value) {\r\n\t\t\t\t\t\tthis.formData.number = quantityField.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t// 隐藏加载中\r\n\t\t\t\t\tuni.hideLoading();\r\n\r\n\t\t\t\t\tconsole.error('获取表单配置失败', err);\r\n\t\t\t\t\tthis.showToast('获取表单配置失败，请重试');\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tradioChange(e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t},\r\n\r\n\t\t\t// 选择图片\r\n\t\t\tchooseImage() {\r\n\t\t\t\t// 计算还能选择多少张图片\r\n\t\t\t\tconst remainCount = 10 - this.images.length;\r\n\t\t\t\tif (remainCount <= 0) {\r\n\t\t\t\t\tthis.showToast('最多只能上传10张图片');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: remainCount, // 最多可以选择的图片张数\r\n\t\t\t\t\tsizeType: ['original', 'compressed'], // 可以指定是原图还是压缩图，默认二者都有\r\n\t\t\t\t\tsourceType: ['album', 'camera'], // 从相册选择或使用相机拍摄\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('选择图片成功', res.tempFilePaths);\r\n\r\n\t\t\t\t\t\t// 显示上传中的loading\r\n\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\ttitle: '上传中...'\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tconst uploadTasks = [];\r\n\r\n\t\t\t\t\t\t// 循环上传图片\r\n\t\t\t\t\t\tres.tempFilePaths.forEach(path => {\r\n\t\t\t\t\t\t\tuploadTasks.push(this.uploadSingleImage(path));\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// 等待所有上传完成\r\n\t\t\t\t\t\tPromise.all(uploadTasks).then(results => {\r\n\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\tthis.showToast('图片上传成功');\r\n\r\n\t\t\t\t\t\t\t// 将成功的结果添加到图片数组\r\n\t\t\t\t\t\t\tresults.forEach(result => {\r\n\t\t\t\t\t\t\t\tif (result.localPath && result.serverPath) {\r\n\t\t\t\t\t\t\t\t\tthis.images.push(result.localPath);\r\n\t\t\t\t\t\t\t\t\tthis.serverImages.push(result.serverPath);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\tthis.showToast('部分图片上传失败，请重试');\r\n\t\t\t\t\t\t\tconsole.error('上传图片失败', err);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('选择图片失败', err);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t// 上传单张图片\r\n\t\t\tuploadSingleImage(filePath) {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\t// 获取token\r\n\t\t\t\t\tconst token = uni.getStorageSync('token');\r\n\r\n\t\t\t\t\t// 构建上传URL\r\n\t\t\t\t\tconst uploadUrl = this.baseUrl + '/mini/pasture/uploadPic';\r\n\r\n\t\t\t\t\tconsole.log('上传URL:', uploadUrl);\r\n\r\n\t\t\t\t\tuni.uploadFile({\r\n\t\t\t\t\t\turl: uploadUrl,\r\n\t\t\t\t\t\tfilePath: filePath,\r\n\t\t\t\t\t\tname: 'file', // 服务器接收的文件参数名\r\n\t\t\t\t\t\tformData: {\r\n\t\t\t\t\t\t\t// 可以添加额外的表单数据\r\n\t\t\t\t\t\t\tuId: this.uId\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t'Authorization': 'Bearer ' + token\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tconsole.log('上传成功', res);\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t// 解析返回的数据\r\n\t\t\t\t\t\t\t\tconst data = typeof res.data === 'string' ? JSON.parse(res.data) : res\r\n\t\t\t\t\t\t\t\t\t.data;\r\n\t\t\t\t\t\t\t\tconsole.log('解析后的数据:', data.imgUrl);\r\n\r\n\t\t\t\t\t\t\t\t// 保存图片URL\r\n\t\t\t\t\t\t\t\tif (data.imgUrl) {\r\n\t\t\t\t\t\t\t\t\tthis.imagesUrl.push(data.imgUrl);\r\n\t\t\t\t\t\t\t\t\t// 更新picUrlList字段\r\n\t\t\t\t\t\t\t\t\tthis.formData.picUrlList = this.imagesUrl.join(',');\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// 修正：API返回的成功码是200而不是1\r\n\t\t\t\t\t\t\t\tif (data.code === 200 || data.code === 1) {\r\n\t\t\t\t\t\t\t\t\t// 提取图片URL路径\r\n\t\t\t\t\t\t\t\t\tconst imgUrl = data.imgUrl || (data.data && data.data.imgUrl) ||\r\n\t\t\t\t\t\t\t\t\t\tdata.data;\r\n\t\t\t\t\t\t\t\t\tconsole.log('提取的图片URL:', imgUrl);\r\n\r\n\t\t\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\t\t\tlocalPath: filePath,\r\n\t\t\t\t\t\t\t\t\t\tserverPath: imgUrl\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tconsole.error('上传失败:', data);\r\n\t\t\t\t\t\t\t\t\treject(new Error(data.msg || '上传失败'));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\tconsole.error('解析上传结果失败', e, res);\r\n\t\t\t\t\t\t\t\t// 如果返回的是字符串且包含成功信息，也认为是成功的\r\n\t\t\t\t\t\t\t\tif (typeof res.data === 'string' && res.data.includes('成功')) {\r\n\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\t\t\t\tlocalPath: filePath,\r\n\t\t\t\t\t\t\t\t\t\t\t// 尝试从字符串中提取URL\r\n\t\t\t\t\t\t\t\t\t\t\tserverPath: JSON.parse(res.data).imgUrl || res.data\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t} catch (innerError) {\r\n\t\t\t\t\t\t\t\t\t\treject(innerError);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\treject(e);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\tconsole.error('上传失败', err);\r\n\t\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t// 删除图片\r\n\t\t\tdeleteImage(index) {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\tcontent: '确定要删除这张图片吗？',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t// 同时删除本地路径和服务器路径\r\n\t\t\t\t\t\t\tthis.images.splice(index, 1);\r\n\t\t\t\t\t\t\tthis.serverImages.splice(index, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t// 选择视频\r\n\t\t\tchooseVideo() {\r\n\t\t\t\tuni.chooseVideo({\r\n\t\t\t\t\tsourceType: ['album', 'camera'], // 从相册选择或使用相机拍摄\r\n\t\t\t\t\tmaxDuration: 60, // 拍摄视频最长时间，单位秒\r\n\t\t\t\t\tcamera: 'back',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('选择视频成功', res);\r\n\r\n\t\t\t\t\t\t// 检查视频时长是否符合要求（不低于20秒）\r\n\t\t\t\t\t\tif (res.duration < 20) {\r\n\t\t\t\t\t\t\tthis.showToast('视频时长不能少于20秒，请重新选择');\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 显示上传中\r\n\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\ttitle: '视频上传中...'\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// 先更新本地预览\r\n\t\t\t\t\t\tthis.videoUrl = res.tempFilePath;\r\n\t\t\t\t\t\tthis.videoDuration = res.duration;\r\n\r\n\t\t\t\t\t\t// 可以使用视频的封面图作为封面，如果有的话\r\n\t\t\t\t\t\tif (res.thumbTempFilePath) {\r\n\t\t\t\t\t\t\tthis.videoPoster = res.thumbTempFilePath;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 上传视频到服务器\r\n\t\t\t\t\t\t// 使用uni.uploadFile替换直接调用API\r\n\t\t\t\t\t\t// 构建上传URL\r\n\t\t\t\t\t\tconst uploadUrl = this.baseUrl + '/mini/pasture/uploadVideo';\r\n\r\n\t\t\t\t\t\tconsole.log('上传视频URL:', uploadUrl);\r\n\r\n\t\t\t\t\t\t// 获取token\r\n\t\t\t\t\t\tconst token = uni.getStorageSync('token');\r\n\r\n\t\t\t\t\t\tuni.uploadFile({\r\n\t\t\t\t\t\t\turl: uploadUrl,\r\n\t\t\t\t\t\t\tfilePath: res.tempFilePath,\r\n\t\t\t\t\t\t\tname: 'file', // 服务器接收的文件参数名\r\n\t\t\t\t\t\t\tformData: {\r\n\t\t\t\t\t\t\t\t// 可以添加额外的表单数据\r\n\t\t\t\t\t\t\t\tuId: this.uId,\r\n\t\t\t\t\t\t\t\tduration: res.duration\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t\t'Authorization': 'Bearer ' + token\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsuccess: (uploadRes) => {\r\n\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\tconsole.log('视频上传成功', uploadRes);\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tconst data = typeof uploadRes.data === 'string' ? JSON.parse(\r\n\t\t\t\t\t\t\t\t\t\tuploadRes.data) : uploadRes.data;\r\n\t\t\t\t\t\t\t\t\tconsole.log('解析后的视频数据:', data);\r\n\r\n\t\t\t\t\t\t\t\t\t// 修正：API返回的成功码是200而不是1\r\n\t\t\t\t\t\t\t\t\tif (data.code === 200 || data.code === 1) {\r\n\t\t\t\t\t\t\t\t\t\t// 提取视频URL路径\r\n\t\t\t\t\t\t\t\t\t\tconst videoUrl = data.imgUrl || data.videoUrl || (data\r\n\t\t\t\t\t\t\t\t\t\t\t.data && (data.data.imgUrl || data.data.videoUrl)\r\n\t\t\t\t\t\t\t\t\t\t) || data.data;\r\n\t\t\t\t\t\t\t\t\t\tconsole.log('提取的视频URL:', videoUrl);\r\n\t\t\t\t\t\t\t\t\t\tthis.formData.videoUrl = videoUrl;\r\n\t\t\t\t\t\t\t\t\t\tthis.serverVideoUrl = videoUrl;\r\n\t\t\t\t\t\t\t\t\t\tthis.showToast('视频上传成功');\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tconsole.error('视频上传失败:', data);\r\n\t\t\t\t\t\t\t\t\t\tthis.showToast(data.msg || '视频上传失败，请重试');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\tconsole.error('解析视频上传结果失败', e, uploadRes);\r\n\t\t\t\t\t\t\t\t\t// 如果返回的是字符串且包含成功信息，也认为是成功的\r\n\t\t\t\t\t\t\t\t\tif (typeof uploadRes.data === 'string' && uploadRes.data\r\n\t\t\t\t\t\t\t\t\t\t.includes('成功')) {\r\n\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t// 尝试从字符串中提取URL\r\n\t\t\t\t\t\t\t\t\t\t\tthis.serverVideoUrl = JSON.parse(uploadRes.data)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.imgUrl || uploadRes.data;\r\n\t\t\t\t\t\t\t\t\t\t\tthis.showToast('视频上传成功');\r\n\t\t\t\t\t\t\t\t\t\t} catch (innerError) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.showToast('视频上传成功，但处理响应失败');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tthis.showToast('视频上传失败，请重试');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\tconsole.error('视频上传失败', err);\r\n\t\t\t\t\t\t\t\tthis.showToast('视频上传失败，请重试');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('选择视频失败', err);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tpreviewImage(current, urls) {\r\n\t\t\t\t// 创建完整的URL数组（添加域名前缀，如果是网络图片）\r\n\t\t\t\tlet imageUrls = [];\r\n\r\n\t\t\t\t// 处理相对路径图片，确保在小程序中能正确显示\r\n\t\t\t\tif (urls && urls.length) {\r\n\t\t\t\t\timageUrls = [...urls];\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 如果只有一张图片\r\n\t\t\t\t\timageUrls = [current];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log('预览图片', current, imageUrls);\r\n\r\n\t\t\t\t// 调用预览API\r\n\t\t\t\tuni.previewImage({\r\n\t\t\t\t\tcurrent: current,\r\n\t\t\t\t\turls: imageUrls,\r\n\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\tconsole.log('预览图片成功');\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('预览图片失败', err);\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '图片预览失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tsubmitForm() {\r\n\t\t\t\t// 更新settingContent为formList的JSON字符串\r\n\t\t\t\tthis.formData.settingContent = JSON.stringify(this.formList);\r\n\t\t\t\t\r\n\t\t\t\t// 查找并提取总量字段的值赋给number\r\n\t\t\t\tconst quantityField = this.formList.find(item => \r\n\t\t\t\t\titem.name && (item.name.includes('总量/吨') || item.name.includes('总量/亩')));\r\n\t\t\t\t\r\n\t\t\t\tif (quantityField && quantityField.value) {\r\n\t\t\t\t\tthis.formData.number = quantityField.value;\r\n\t\t\t\t\tconsole.log('提取总量字段:', quantityField.name, '值为:', quantityField.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 如果没找到，尝试查找其他可能的字段名\r\n\t\t\t\t\tconst alternativeField = this.formList.find(item => \r\n\t\t\t\t\t\titem.name && (\r\n\t\t\t\t\t\t\titem.name.includes('总量') || \r\n\t\t\t\t\t\t\titem.name.includes('数量') || \r\n\t\t\t\t\t\t\titem.name.includes('吨数') || \r\n\t\t\t\t\t\t\titem.name.includes('亩数')\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (alternativeField && alternativeField.value) {\r\n\t\t\t\t\t\tthis.formData.number = alternativeField.value;\r\n\t\t\t\t\t\tconsole.log('提取替代总量字段:', alternativeField.name, '值为:', alternativeField.value);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log('未找到总量相关字段，number字段为空');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log('提交前表单数据:', this.formData);\r\n\t\t\t\t\r\n\t\t\t\t// ======== 表单验证 ========\r\n\t\t\t\t// 1. 验证表单中的必填字段\r\n\t\t\t\tconst requiredFields = [];\r\n\r\n\t\t\t\tfor (let item of this.formList) {\r\n\t\t\t\t\t// 检查每个表单项是否填写\r\n\t\t\t\t\tif (!item.value || item.value.trim() === '') {\r\n\t\t\t\t\t\trequiredFields.push(item.name);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (requiredFields.length > 0) {\r\n\t\t\t\t\tthis.showToast(`请填写${requiredFields.join('、')}`);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 2. 验证图片数量\r\n\t\t\t\tif (this.images.length < 5) {\r\n\t\t\t\t\tthis.showToast('请至少上传5张照片');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 3. 验证视频\r\n\t\t\t\tif (!this.videoUrl) {\r\n\t\t\t\t\tthis.showToast('请上传视频');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 4. 验证地址\r\n\t\t\t\tif (!this.formData.addressIds) {\r\n\t\t\t\t\tthis.showToast('请选择地理位置');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 5. 验证是否所有资源都已上传到服务器\r\n\t\t\t\tif (this.images.length !== this.serverImages.length || this.imagesUrl.length === 0) {\r\n\t\t\t\t\tthis.showToast('图片正在上传中，请稍后提交');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!this.serverVideoUrl || !this.formData.videoUrl) {\r\n\t\t\t\t\tthis.showToast('视频正在上传中，请稍后提交');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 6. 确保addressNames有值\r\n\t\t\t\tif (!this.formData.addressNames) {\r\n\t\t\t\t\tthis.formData.addressNames = this.formData.addressIds;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 所有验证通过，提交表单\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '提交中...'\r\n\t\t\t\t});\r\n\r\n\r\n\t\t\t\t// 再次检查所有必填字段是否都有值\r\n\t\t\t\tfor (const key in this.formData) {\r\n\t\t\t\t\tconsole.log(`${key}: ${this.formData[key]}`);\r\n\t\t\t\t\tif (!this.formData[key] && key !== 'stringtype') { // stringtype可能是空的\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tthis.showToast(`${key}未填写，请检查`);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log('最终提交的表单数据', this.formData);\r\n\r\n\t\t\t\t// 调用添加接口\r\n\t\t\t\tuserApi.add(this.formData).then(res => {\r\n\t\t\t\t\tuni.hideLoading();\r\n\r\n\t\t\t\t\tif (res.code === 200 || res.code === 1) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '提交成功',\r\n\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// 提交成功后，返回上一页\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tuni.navigateBack();\r\n\t\t\t\t\t\t}, 1500);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.showToast(res.msg || '提交失败，请重试');\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tconsole.error('提交失败', err);\r\n\t\t\t\t\tthis.showToast('提交失败，请重试');\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t// 获取地区ID，实际项目中可能需要从其他API获取\r\n\t\t\tgetAddressIds() {\r\n\t\t\t\t// 这里简单处理，实际可能需要调用API获取真实的地区ID\r\n\t\t\t\t// 或者在选择地区时就保存对应的ID\r\n\t\t\t\treturn `${this.region.province},${this.region.city},${this.region.area}`;\r\n\t\t\t},\r\n\r\n\t\t\tshowToast(title) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: title,\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tresetForm() {\r\n\t\t\t\tthis.formData = {\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\tphone: '',\r\n\t\t\t\t\tnotes: '',\r\n\t\t\t\t\tcompany: '',\r\n\t\t\t\t\tmu: '',\r\n\t\t\t\t\tseedType: '',\r\n\t\t\t\t\tavgHeight: '',\r\n\t\t\t\t\tdensity: '',\r\n\t\t\t\t\trfv: '185',\r\n\t\t\t\t\tgreenLevel: '9',\r\n\t\t\t\t\tcutCount: '1',\r\n\t\t\t\t\tpackaging: 'large'\r\n\t\t\t\t};\r\n\t\t\t\tthis.images = [];\r\n\t\t\t\tthis.serverImages = [];\r\n\t\t\t\tthis.videoUrl = '';\r\n\t\t\t\tthis.serverVideoUrl = '';\r\n\t\t\t\tthis.videoDuration = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\tpage {\r\n\t\tbackground-color: #f5f6f9;\r\n\t}\r\n\r\n\t.footer-placeholder {\r\n\t\theight: 240rpx;\r\n\t\t/* 底部footer的高度+padding */\r\n\t}\r\n\r\n\t/* 上传区域公共样式 */\r\n\t.upload-section {\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.upload-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 20rpx;\r\n\r\n\t\t.upload-subtitle {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tfont-weight: normal;\r\n\t\t\tcolor: #999;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 照片上传样式 */\r\n\t.image-upload-area {\r\n\t\tdisplay: flex;\r\n\t\tflex-wrap: wrap;\r\n\t}\r\n\r\n\t.image-list {\r\n\t\tdisplay: flex;\r\n\t\tflex-wrap: wrap;\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.image-item {\r\n\t\twidth: calc((100% - 30rpx) / 3);\r\n\t\theight: 220rpx;\r\n\t\tmargin-right: 15rpx;\r\n\t\tmargin-bottom: 15rpx;\r\n\t\tposition: relative;\r\n\r\n\t\t/* 每行第三个元素不需要右边距 */\r\n\t\t&:nth-child(3n) {\r\n\t\t\tmargin-right: 0;\r\n\t\t}\r\n\r\n\t\timage {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100%;\r\n\t\t\tborder-radius: 8rpx;\r\n\t\t}\r\n\r\n\t\t.delete-icon {\r\n\t\t\tposition: absolute;\r\n\t\t\ttop: 5rpx;\r\n\t\t\tright: 5rpx;\r\n\t\t\twidth: 40rpx;\r\n\t\t\theight: 40rpx;\r\n\t\t\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\t\t\tborder-radius: 50%;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t\tz-index: 10;\r\n\t\t}\r\n\t}\r\n\r\n\t.upload-button {\r\n\t\twidth: calc((100% - 30rpx) / 3);\r\n\t\theight: 220rpx;\r\n\t\tborder: 2rpx dashed #ddd;\r\n\t\tborder-radius: 8rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #f8f8f8;\r\n\t}\r\n\r\n\t.upload-icon {\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\r\n\t.upload-text {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t/* 视频上传样式 */\r\n\t.video-upload-button {\r\n\t\twidth: 100%;\r\n\t\theight: 300rpx;\r\n\t\tborder: 2rpx dashed #ddd;\r\n\t\tborder-radius: 8rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #f8f8f8;\r\n\t}\r\n\r\n\t.video-container {\r\n\t\tposition: relative;\r\n\t\twidth: 100%;\r\n\t\theight: 400rpx;\r\n\t}\r\n\r\n\t.video-player {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tborder-radius: 8rpx;\r\n\t}\r\n\r\n\t.edit-video-btn {\r\n\t\tposition: absolute;\r\n\t\tright: 20rpx;\r\n\t\tbottom: 20rpx;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\t\tcolor: #fff;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 10rpx 20rpx;\r\n\t\tborder-radius: 30rpx;\r\n\r\n\t\t.edit-video-text {\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tmargin-left: 10rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 单选按钮样式 */\r\n\t.radio-item {\r\n\t\talign-items: flex-start;\r\n\t\tpadding: 15rpx 0;\r\n\t}\r\n\r\n\t.radio-group {\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t::v-deep .u-radio-group {\r\n\t\tjustify-content: flex-end;\r\n\t\tflex-wrap: wrap;\r\n\t}\r\n\r\n\t::v-deep .u-radio {\r\n\t\tmargin-left: 20rpx;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\r\n\t::v-deep .u-radio__label {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #606266;\r\n\t}\r\n\r\n\t.slogan {\r\n\t\tpadding: 40rpx 0 20rpx 40rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tcolor: #357A3E;\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 500;\r\n\t\tline-height: 1.6;\r\n\t}\r\n\r\n\t.enterImg {\r\n\t\twidth: 100%;\r\n\t\theight: 190rpx;\r\n\r\n\t\timage {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 190rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t.bg-header {\r\n\t\tleft: 0rpx;\r\n\t\ttop: -34rpx;\r\n\t\twidth: 100%;\r\n\t\theight: 724rpx;\r\n\t\topacity: 1;\r\n\t\tborder-radius: 0rpx 0rpx, 16rpx, 16rpx;\r\n\t\tbackground: linear-gradient(180deg, rgba(99, 184, 114, 1) 0%, rgba(245, 246, 249, 1) 100%);\r\n\t\tposition: absolute;\r\n\t\tz-index: -1;\r\n\t}\r\n\r\n\t.page-container {\r\n\t\t// position: relative;\r\n\t\tpadding: 0 30rpx;\r\n\t}\r\n\r\n\t.form-container {\r\n\t\tmargin-top: 0rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tbox-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.form-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 500;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.form-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 10rpx 0;\r\n\t\tborder-bottom: 2rpx solid #f5f6f9;\r\n\t}\r\n\r\n\t.textarea-item {\r\n\t\talign-items: flex-start;\r\n\t\tpadding: 20rpx 0;\r\n\t}\r\n\r\n\t.item-label {\r\n\t\twidth: 160rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.item-input {\r\n\t\tflex: 1;\r\n\t\ttext-align: right;\r\n\t}\r\n\r\n\t.footer {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 30rpx 30rpx 60rpx 30rpx;\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground-color: #fff;\r\n\t\tz-index: 999;\r\n\t\tbox-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n\r\n\t\t.btn {\r\n\t\t\twidth: 100%;\r\n\r\n\t\t\t::v-deep .u-button {\r\n\t\t\t\tborder: none !important;\r\n\t\t\t\tbackground: linear-gradient(237.74deg, rgba(114, 186, 112, 1) 0%, rgba(53, 122, 62, 1) 100%);\r\n\t\t\t\theight: 88rpx !important;\r\n\t\t\t}\r\n\r\n\t\t\tbutton {\r\n\t\t\t\tborder-radius: 44rpx;\r\n\t\t\t\tbackground: linear-gradient(237.74deg, rgba(114, 186, 112, 1) 0%, rgba(53, 122, 62, 1) 100%);\r\n\t\t\t\tborder: none !important;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\theight: 88rpx;\r\n\t\t\t\tline-height: 88rpx;\r\n\t\t\t\tfont-size: 32rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import mod from \"-!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./enterGrass.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.3.5.3.20220729\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./enterGrass.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1752451967798\n      var cssReload = require(\"E:/HBuilderX.3.5.3.20220729/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}